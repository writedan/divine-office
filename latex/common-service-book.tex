\documentclass[14pt,openany]{book}
\usepackage{multicol}
\usepackage{paracol}
% Columned settings
\setlength{\columnseprule}{0.025pt}
\setlength{\columnsep}{1.5em}
\setlength{\topskip}{7pt}

\usepackage{enumitem}
\usepackage{textcomp}
\usepackage{csquotes}
% Fonts and typography
\usepackage{fontspec}
\setmainfont{Libre Baskerville}[
Scale=1.0,
Ligatures=TeX
]
\usepackage[]{geometry}
\geometry{
	paperwidth=8.5in,
	paperheight=11in,
	inner=1.5cm,
	outer=1cm,
	top=1.5cm,
	bottom=1.5cm,
	headsep=0.5cm,
	showframe=false
}
% Headers and footers - simplified to just page number at bottom
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
\renewcommand{\headrulewidth}{0pt}
\fancyfoot[C]{\thepage}
% Typography and text styling
\usepackage{microtype} % Improved typography
\usepackage{lettrine} % Fancy chapter initials
% Color and design
\usepackage[dvipsnames,svgnames,x11names]{xcolor}
\definecolor{rubric}{RGB}{200,0,0} % Traditional red for rubrics
\definecolor{pagecolor}{RGB}{245,240,220} % Slightly aged paper color
% Table of contents styling
\usepackage{titletoc}
\usepackage{luacode}
\usepackage{luapackageloader}

\contentsmargin{0pt}
\titlecontents{chapter}[0pt]
{\addvspace{10pt}\bfseries}
{\contentslabel{0pt}\hspace*{0pt}}
{}
{\hfill\contentspage}
\usepackage[autocompile,allowdeprecated=false]{gregoriotex}
\gredefsizedsymbol{GreCross}{greextra}{Cross}
\gredefsizedsymbol{GreDagger}{greextra}{Dagger}
\gredefsizedsymbol{GreCrossAlt}{greextra}{Cross.alt}
\gredefsizedsymbol{GreStarHeight}{greextra}{StarHeight}
\gredefsizedsymbol{greABar}{greextra}{ABar}
\gredefsizedsymbol{greVBar}{greextra}{VBar}
\gredefsizedsymbol{greRBar}{greextra}{RBar}
\gresetspecial{r}{\textcolor{rubric}{\Rbar{}.}}
\gresetspecial{v}{\textcolor{rubric}{\Vbar{}.}}
\gresetspecial{a}{\textcolor{rubric}{\Abar{}.}}
\gresetspecial{r/}{\textcolor{rubric}{\Rbar{}}}
\gresetspecial{v/}{\textcolor{rubric}{\Vbar{}}}
\gresetspecial{a/}{\textcolor{rubric}{\Abar{}}}
\gresetspecial{+}{\textcolor{rubric}{\GreCross{17}}}
\gresetspecial{1}{\textcolor{rubric}{\GreDagger{17}}}
\gresetspecial{2}{\textcolor{rubric}{\GreCrossAlt{17}}}
\gresetspecial{*}{\textcolor{rubric}{\GreStarHeight{17}}}
\usepackage{parskip}
\newcommand{\import}[1]{\textbf{#1}}

% ribbons
\newcommand{\whiteribbon}[0]{\textcolor{black}{\textbf{white ribbon}} }%
\newcommand{\greenribbon}[0]{\textcolor{ForestGreen}{\textbf{green ribbon}} }%
\newcommand{\redribbon}[0]{\textcolor{red}{\textbf{red ribbon}} }%
\newcommand{\blueribbon}[0]{\textcolor{blue}{\textbf{blue ribbon}} }%
\newcommand{\goldribbon}[0]{\textcolor{DarkGoldenrod3}{\textbf{gold ribbon}} }%

% Custom chapter and section styling with non-cumulative spacing
\usepackage{titlesec}
\usepackage{etoolbox}

% Custom chapter style - centered, red, uppercase, no numbering
\titleformat{\chapter}[display]
{\bfseries\centering}
{}
{0pt}
{\color{rubric}\LARGE\MakeUppercase}
\titlespacing*{\chapter}{0pt}{12pt}{0pt}

% Custom section style - centered, black, uppercase, no numbering
\titleformat{\section}[display]
{\bfseries\centering}
{}
{0pt}
{\Large\MakeUppercase}
\titlespacing*{\section}{0pt}{5pt}{10pt}

% This patch prevents cumulative spacing when a section follows a chapter

% This will eventually load up a Lua script using WASM to handle importation, parsing, and compilation of specified files.
\newcommand{\doimport}[1]{IMPORT: \textbf{../backend/#1}}

% Rubrication and notation
\newcommand{\rubric}[1]{\textcolor{rubric}{\small\textparagraph \textit{#1}}}
\newcommand{\liturgicaltext}[1]{\textit{#1}}
% Ensure parts start on even-numbered (left-sided) pages
\makeatletter
\newcounter{thepartcounter}
\setcounter{thepartcounter}{1}
\renewcommand{\thethepartcounter}{\Roman{thepartcounter}}
\renewcommand{\part}[1]{%
	\clearpage
	% If current page is odd, add a blank page to make next page even
	\ifodd\c@page
	\null
	\thispagestyle{empty}
	\clearpage
	\fi
	% Now we're on an even page
	\thispagestyle{empty}
	\vspace*{\fill}
	\begin{center}
		{\Huge \selectfont \textbf{PART \textcolor{rubric}{\thethepartcounter}.}}\par
	\end{center}
	\vspace*{\fill}
	\stepcounter{thepartcounter}
	\clearpage
	% Now we're on the next (odd) page
	\thispagestyle{empty}
	\vspace*{\fill}
	\begin{center}
		{\Huge \selectfont \textbf{\MakeUppercase{#1}}}\par
	\end{center}
	\vspace*{\fill}
}
\makeatother

\begin{luacode*}
	-- Load the divine_latex module
	--package.path = "./?.lua;" .. package.path  -- Make sure module can be found
	--package.preload['divine_office'] = require "divine_office"
	divine_latex = require("do_mod")
	
	-- Define a function to be called from LaTeX
	function do_liturgical_module(file_path)
		tex.print(divine_latex.domod(file_path))
	end
\end{luacode*}

\newcommand{\domod}[1]{%
	\luadirect{do_liturgical_module("#1")}%
}

\begin{document}
	\begin{titlepage}
		\vspace*{\fill}
		\begin{center}
			{\Huge\bfseries The Common Service Book}\\[1cm]
			{\Large Containing the Psalter of David}\par
			{\Large and the Administration of the Sacraments.}
			\vfill
			{A. D. \textcolor{rubric}{MMXXV}}.
		\end{center}
	\end{titlepage}

	\clearpage
	
	\tableofcontents
	
	\clearpage
	
	\chapter{The Preface}
	
		Dearest brethren in the Lord Jesus Christ: I could not count up in their exact number those highest blessings which have been heaped upon us by God and by which he has bound us to himself and rendered us obedient, even if I possessed one hundred tongues and one hundred mouths; from which blessings we are able to understand how deeply he has loved us, even though we are unworthy. Therefore, we are ungrateful and certainly unworthy of such great and magnificent benevolence on the part of our Lord if, in return for the many and so great benefits with which he has enriched us and which he has heaped upon us, and yet does not cease daily to adorn and laden us, we do not try to offer him the greatest thanks of which we are able. Accordingly, let us try to please him in this manner at least, since no other is allowed us, lest we should seem unmindful of his outstanding goodness toward us. 
		
		Let us therefore look up to him and worship him, let us earnestly sing his praises and his triumphs, let us sing with the angels \enquote{Glory to God in the highest}, who has opened for us the door to the heavenly Jerusalem, closed and bolted for so many ages before, motivated solely by his goodness. And it is in order that this might be done more easily in all the churches in this Christ's Kingdom that there has been published this book, in which the divine praises and heavenly songs have been set forth. Therefore, receive this book and embrace its incomparable treasure, and let nothing keep you from the divine services.
		
		Ready yourselves, all of you, for the divine praises, so that Christ, the greatest and the best, may be lauded, honored, hymned, celebrated, adored, glorified, and worshiped in all the churches of the saints.
		
	\part{The Divine Office}
	
		\chapter{Preparation for Mass}
		
			\domod{vespers/friday.lit}

	\part{The Lectionary}
	
	\part{The Sacramentary}
	
	\part{The Confessions}
\end{document}